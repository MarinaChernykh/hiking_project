{% extends "base.html" %}
{% load static %}
{% load custom_tags %}

{% block title %}
  {{ trail.name }}
{% endblock title %}

{% block main_banner %}
  <div class="main-banner-gradient">
    <img src="{{ trail.main_image.url }}" alt="{{ trail.name }}" class="main-banner">
    <img src="{{ trail.mobile_image.url }}" alt="{{ trail.name }}" class="main-banner-mobile">
  </div>
{% endblock main_banner %}

{% block article_title %}
  <h1 class="top__title main-title">{{ trail.name }}</h1>
{% endblock article_title %}

{% block content %}
<section class="trail-info center">
  <div class="trail-info__item">
    <img src="{% static "img/trail_logos/distance.jpg" %}" alt="Дистанция" class="trail-info__img">
    <p class="trail-info__name text-medi-bold">Общее расстояние</p>
    <p class="trail-info__value text">{{ trail.distance }} км</p>
  </div>
  <div class="trail-info__item">
    <img src="{% static "img/trail_logos/time.png" %}" alt="Время" class="trail-info__img">
    <p class="trail-info__name text-medi-bold">Общее время</p>
    <p class="trail-info__value text">{{ trail.time }}</p>
  </div>
  <div class="trail-info__item">
    <img src="{% static "img/trail_logos/altitude.jpg" %}" alt="Высота" class="trail-info__img">
    <p class="trail-info__name text-medi-bold">Набор высоты</p>
    <p class="trail-info__value text">{{ trail.elevation_gain }} м</p>
  </div>
  <div class="trail-info__item">
    <img src="{% static "img/trail_logos/type.png" %}" alt="Расстояние" class="trail-info__img">
    <p class="trail-info__name text-medi-bold">Тип маршрута</p>
    <p class="trail-info__value text">{{ trail.get_route_type_display }}</p>
  </div>
  <div class="trail-info__item">
    <img src="{% static "img/trail_logos/ranking.png" %}" alt="Рейтинг" class="trail-info__img">
    <p class="trail-info__name text-medi-bold">Рейтинг маршрута</p>
    {% if average_rating %}
      <p class="trail-info__value text">{{ average_rating|floatformat:1 }} из 5</p>
    {% else %}
      <p class="trail-info__value text">---</p>
    {% endif %}
  </div>
  <div class="trail-info__item">
    <img src="{% static "img/trail_logos/level.png" %}" alt="Сложность" class="trail-info__img">
    <p class="trail-info__name text-medi-bold">Уровень сложности</p>
    <p class="trail-info__value text">{{ trail.get_level_display }}</p>
  </div>
</section>

<article class="article center">
  <main class="trail-intro">
    <p class="text article-text">
      {{ trail.short_description|safe }}
    </p>
    {% if trail.previous_trail %}
    <p class="text article-text">
      Этот трек является продолжением маршрута
      <a href="{% url "trails:trail_detail" trail.previous_trail.slug %}" class="text-underlined">{{ trail.previous_trail.name }}</a>.
    </p>
    {% endif %}
    <p class="text article-text">
      <span class="text-bold">Начало маршрута: </span>{{ trail.start_point }}<br>
      {{ trail.start_point_description|safe }}
    </p>
    <p class="text article-text">
      <span class="text-bold">Вода на маршруте: </span>{{ trail.aqua|safe }}
    </p>
  </main>
  <div class="photo-gallery">
    {% with trail.photos.all as images %}
      <img src="{{ images.0.image.url }}" alt="{{ trail.name }}" class="large_image">
      <div class="photo-gallery__row">
        <img src="{{ images.1.image.url }}" alt="{{ trail.name }}" class="small_image">
        <img src="{{ images.2.image.url }}" alt="{{ trail.name }}" class="small_image">
      </div>
      <img src="{{ images.3.image.url }}" alt="{{ trail.name }}" class="large_image">
    {% endwith %}
  </div>
  <section class="trail-description">
    <h2 class="trail-description__title title">Описание маршрута</h2>
    <p class="text article-text">
      {{ trail.full_description|safe }}
    </p>
    {% if trail.next_trail %}
      <p class="text article-text">
        Если у&nbsp;вас остались силы, время и&nbsp;желание, то&nbsp;у&nbsp;этого маршрута есть продолжение&nbsp;&mdash; трек
        <a
          href="{% url "trails:trail_detail" trail.next_trail.slug %}"
          class="trail-description__text underlined">{{ trail.next_trail.name }}
      </a>.
      </p>
    {% endif %}
    <div class="trail-map">
      {% if trail.route_image %}
        <iframe
        src="{{ trail.route_image }}" title="Embeded MapMagic map with routes" frameBorder="0" allowFullScreen="">
        </iframe>
      {% endif %}
    </div>
  </section>
</article>

<section class="comments article center">
  <h2 class="comments__title title">Комментарии</h2>
  <p class="text article-text">
    Если вы&nbsp;уже проходили этот маршрут, поделитесь, насколько он&nbsp;вам понравился, поставив оценку. Уверена, что рейтинг маршрута поможет другим спланировать свой отпуск и&nbsp;выбрать самые красивые треки!<br><br>
    Ну&nbsp;и&nbsp;конечно, будем рады вашим рассказам о&nbsp;прогулках по&nbsp;этим маршрутам, оставленным в&nbsp;комментариях. Поделитесь свежими новостями о&nbsp;состоянии трека, актуальных переправах через реки и&nbsp;ручьи и&nbsp;другой полезной информацией&nbsp;&mdash; мир скажет вам спасибо :)
  </p>
  <div class="form-comments__form">
    {% include 'users/includes/errors_check.html' %}
    <form method="post" action="{% url 'trails:add_comment' trail.slug %}" class="form-comments__form-and-button">
      {% include 'trails/includes/comment_form.html' %}
      <input type="submit" value="Сохранить" class="body-button form-button form-button-text">
    </form>
  </div>
  <div class="comments__user-texts">
    {% include "trails/includes/comments.html" %}
    {% if count > COMMENTS_NUMBER_TRAIL_PAGE %}
    <a href="{% url "trails:comments_list" trail.slug %}" class="comments__button body-button body-button-text">
      Все комментарии
    </a>
    {% endif %}
  </div>
</section>

{% with trail.region as region %}
  {% show_top_trails TRAILS_NUMBER_TRAIL_PAGE region %}
{% endwith %}

{% endblock content %}